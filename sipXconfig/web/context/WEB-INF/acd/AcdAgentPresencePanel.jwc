<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE component-specification PUBLIC "-//Apache Software Foundation//Tapestry Specification 4.0//EN" "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">
<!-- generated by Spindle, http://spindle.sourceforge.net -->

<component-specification class="org.sipfoundry.sipxconfig.site.acd.AcdPresenceServer"
  allow-body="no" allow-informal-parameters="no">
  <description>Presence Server page Status/Sign In/Sign Out</description>

  <inject property="acdContext" object="spring:acdContext"/>
  <inject property="coreContext" object="spring:coreContext"/>
  <inject property="presenceServer" object="spring:presenceServer"/>
  <inject property="locationsManager" object="spring:locationsManager"/>

  <parameter name="allowedUsers" default-value="acdContext.usersWithAgents"/>

  <property name="currentLocationId" persist="session"/>
  <property name="currentUser"/>
  <property name="users"/>
  <property name="selections"
    initial-value="new org.sipfoundry.sipxconfig.components.SelectMap()" />

  <bean name="validator" class="org.sipfoundry.sipxconfig.components.SipxValidationDelegate" />
  <bean name="presenceFormat" class="org.sipfoundry.sipxconfig.components.EnumFormat" lifecycle="page">
    <set name="messages" value="messages"/>
    <set name="prefix" value="literal:presence"/>
  </bean>

  <component id="locationSelector" type="PropertySelection">
    <binding name="model" value="locationSelectionModel" />
    <binding name="value" value="currentLocationId" />
    <binding name="onchange" value="literal:javascript:this.form.submit();"/>
  </component>
  
  <component id="errorMsg" type="common/ErrorMsg">
    <binding name="validator" value="bean:validator"/>  
  </component>
  
  <component id="userTable" type="common/Table">
    <binding name="source" value="users"/>
    <binding name="row" value="currentUser"/>
	  <binding name="columns" value="literal:* user:userName, status:status"/>
  	<binding name="selections" value="selections"/>
  </component>

  <component id="statusLabel" type="Insert">
    <binding name="value" value="currentUserStatus"/>
    <binding name="format" value="bean:presenceFormat"/>    
  </component> 
  
</component-specification>
