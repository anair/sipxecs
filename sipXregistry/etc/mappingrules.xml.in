<?xml version="1.0" encoding="UTF-8"?>

<mappings xmlns="http://www.sipfoundry.org/sipX/schema/xml/urlmap-00-00">
  <hostMatch>
    <hostPattern>${SIPXCHANGE_DOMAIN_NAME}</hostPattern>
    <hostPattern>${MY_FULL_HOSTNAME}</hostPattern>
    <hostPattern>${MY_HOSTNAME}</hostPattern>
    <hostPattern>${MY_IP_ADDR}</hostPattern>
    <userMatch>
      <!--Music on Hold-->
      <description>Forward music on hold calls to Park Server</description>
      <userPattern>~~mh~</userPattern>
      <permissionMatch>
        <transform>
          <url>&lt;sip:moh@${ORBIT_SERVER_SIP_SRV_OR_HOSTPORT}&gt;</url>
        </transform>
      </permissionMatch>
    </userMatch>
    <userMatch>
      <!--RLS-->
      <description>Forward resource list subscriptions to RLS</description>
      <userPattern>~~rl~.</userPattern>
      <permissionMatch>
        <transform>
          <headerparams>Route=sip:${RLS_SIP_SRV_OR_HOSTPORT}</headerparams>
        </transform>
      </permissionMatch>
    </userMatch>
    <userMatch>
      <!--AutoAttendant-->
      <description>Default autoattendant dialing plan</description>
      <userPattern>100</userPattern>
      <userPattern>operator</userPattern>
      <userPattern>0</userPattern>
      <permissionMatch>
        <transform>
          <url>&lt;sip:{digits}@{mediaserver};voicexml={voicemail}%2Fcgi-bin%2Fvoicemail%2Fmediaserver.cgi%3Faction%3Dautoattendant%26name%3Daa_8&gt;</url>
        </transform>
      </permissionMatch>
    </userMatch>
    <userMatch>
      <description>Default internal dialing plan</description>
      <userPattern>101</userPattern>
      <permissionMatch>
        <transform>
          <url>&lt;sip:{digits}@{mediaserver};voicexml={voicemail}%2Fcgi-bin%2Fvoicemail%2Fmediaserver.cgi%3Faction%3Dretrieve&gt;</url>
        </transform>
      </permissionMatch>
    </userMatch>
    <userMatch>
      <description>Default internal dialing plan</description>
      <userPattern>8xxx</userPattern>
      <permissionMatch>
        <transform>
          <url>&lt;sip:{vdigits}@{mediaserver};voicexml={voicemail}%2Fcgi-bin%2Fvoicemail%2Fmediaserver.cgi%3Faction%3Ddeposit%26mailbox%3D{vdigits-escaped}&gt;</url>
        </transform>
      </permissionMatch>
    </userMatch>
    <userMatch>
      <description>Default internal dialing plan</description>
      <userPattern>.</userPattern>
      <permissionMatch>
        <permission>Voicemail</permission>
        <transform>
          <url>&lt;sip:{digits}@{mediaserver};voicexml={voicemail}%2Fcgi-bin%2Fvoicemail%2Fmediaserver.cgi%3Faction%3Ddeposit%26mailbox%3D{digits-escaped}&gt;;q=0.1</url>
        </transform>
      </permissionMatch>
    </userMatch>
  </hostMatch>
</mappings>
